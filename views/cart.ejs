<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Your Shopping Cart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
  <style>
    .gradient-custom {
      background: linear-gradient(45deg, #f5f7fa, #c3cfe2);
    }
  </style>
</head>
<body>
  <section class="h-100 gradient-custom">
    <div class="container py-5">
      <div class="row d-flex justify-content-center my-4">
        <div class="col-md-8">
          <div class="card mb-4">
            <div class="card-header py-3">
              <h5 class="mb-0">Cart - <%= items.length %> item(s)</h5>
            </div>
            <div class="card-body">
              <% if (items.length === 0) { %>
                <p>Your cart is empty.</p>
              <% } else { %>
                <% let total = 0; %>
                <% items.forEach((item, index) => { 
                    total += item.pricing * item.quantity;
                %>
                  <div class="row mb-4">
                    <div class="col-lg-3 col-md-12 mb-4 mb-lg-0">
                      <img src="/img/<%= item.itemType.toLowerCase() %>.jpg" class="w-100 rounded" alt="<%= item.name %>"/>
                    </div>
                    <div class="col-lg-9 col-md-12">
                      <h5><strong><%= item.name %></strong></h5>
                      <p>Category: <%= item.itemType %></p>
                      <p>Price per unit: ₹<%= item.pricing %></p>
                      <p>Quantity: <strong><%= item.quantity %></strong></p>
                      <p>Subtotal: ₹<%= item.pricing * item.quantity %></p>

                      <form action="/remove-from-cart" method="POST" class="d-inline">
                        <input type="hidden" name="itemId" value="<%= item.itemId %>"/>
                        <input type="hidden" name="itemType" value="<%= item.itemType %>"/>
                        <button type="submit" class="btn btn-danger btn-sm">
                          <i class="fas fa-trash"></i> Remove
                        </button>
                      </form>
                    </div>
                  </div>
                  <hr class="my-4" />
                <% }); %>
              <% } %>
            </div>
          </div>
        </div>

        <% if (items.length > 0) { %>
          <div class="col-md-4">
            <div class="card mb-4">
              <div class="card-header py-3">
                <h5 class="mb-0">Summary</h5>
              </div>
              <div class="card-body">
                <ul class="list-group list-group-flush">
                  <li class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 pb-0">
                    Products
                    <span>₹<%= total %></span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                    Shipping
                    <span>Free</span>
                  </li>
                  <li class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 mb-3">
                    <div><strong>Total amount</strong></div>
                    <span><strong>₹<%= total %></strong></span>
                  </li>
                </ul>
                <button type="button" class="btn btn-primary btn-lg btn-block w-100">
                  Go to checkout
                </button>
              </div>
            </div>
          </div>
        <% } %>
      </div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
